# Title: CVE-2024-1708 - ScreenConnect Path Traversal Exploitation
# Author: Matt Anderson, Andrew Schwartz, Caleb Stewart, Huntress
# Date: 2024-02-21
# Level: medium
# Description: This detects file modifications to ASPX and ASHX files within the root of the App_Extensions directory, which is allowed by a ZipSlip vulnerability in versions prior to 23.9.8. This occurs during exploitation of CVE-2024-1708.
# MITRE Tactic: Persistence
# Tags: attack.persistence, cve.2024-1708, detection.emerging-threats
# False Positives:
#   - This will occur legitimately as well and will result in some benign activity.

Image="*\\ScreenConnect.Service.exe" TargetFilename IN ("*ScreenConnect\\App_Extensions\\*.ashx", "*ScreenConnect\\App_Extensions\\*.aspx") NOT TargetFilename="*ScreenConnect\\App_Extensions\\*\\*"