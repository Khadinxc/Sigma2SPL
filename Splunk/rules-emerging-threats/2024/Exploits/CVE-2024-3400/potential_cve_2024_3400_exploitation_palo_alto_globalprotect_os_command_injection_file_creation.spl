# Title: Potential CVE-2024-3400 Exploitation - Palo Alto GlobalProtect OS Command Injection - File Creation
# Author: Andreas Braathen (mnemonic.io)
# Date: 2024-04-25
# Level: medium
# Description: Detects suspicious file creations in the Palo Alto Networks PAN-OS' parent telemetry folder, which are processed by the vulnerable 'dt_curl' script if device telemetry is enabled.
# As said script overrides the shell-subprocess restriction, arbitrary command execution may occur by carefully crafting filenames that are escaped through this function.
# MITRE Tactic: Execution
# Tags: attack.execution, cve.2024-3400, detection.emerging-threats
# False Positives:
#   - The PAN-OS device telemetry function does not enforce a standard filename convention, but observations are unlikely.

TargetFilename IN ("*{IFS}*", "*base64*", "*bash*", "*curl*", "*http*") TargetFilename="/opt/panlogs/tmp/device_telemetry/*"