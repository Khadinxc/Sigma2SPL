# Title: Pikabot Fake DLL Extension Execution Via Rundll32.EXE
# Author: Swachchhanda Shrawan Poudel, Nasreddine Bencherchali (Nextron Systems)
# Date: 2024-01-26
# Level: high
# Description: Detects specific process tree behavior linked to "rundll32" executions, wherein the associated DLL lacks a common ".dll" extension, often signaling potential Pikabot activity.
# MITRE Tactic: Defense Evasion
# Tags: attack.defense-evasion, attack.execution, detection.emerging-threats

CommandLine IN ("*:\\ProgramData\\*", "*:\\Users\\Public\\*", "*:\\Windows\\Installer\\*", "*\\AppData\\Local\\Temp\\*", "*\\AppData\\Roaming\\*") Image="*\\rundll32.exe" ParentImage IN ("*\\cmd.exe", "*\\cscript.exe", "*\\mshta.exe", "*\\powershell.exe", "*\\pwsh.exe", "*\\regsvr32.exe", "*\\wscript.exe") NOT (CommandLine IN ("*.cpl *", "*.cpl,*", "*.dll *", "*.dll,*", "*.inf *", "*.inf,*") OR CommandLine IN ("*.cpl", "*.cpl\"", "*.dll", "*.dll\"", "*.inf", "*.inf\"", "*.cpl'", "*.dll'", "*.inf'"))