# Title: Exploitation Attempt Of CVE-2023-46214 Using Public POC Code
# Author: Lars B. P. Frydenskov(Trifork Security)
# Date: 2023-11-27
# Level: high
# Description: Detects exploitation attempt of CVE-2023-46214, a remote code execution (RCE) in Splunk Enterprise through insecure XML parsing using known public proof of concept code
# MITRE Tactic: Lateral Movement
# Tags: attack.lateral-movement, attack.t1210, cve.2023-46214, detection.emerging-threats
# False Positives:
#   - Unlikely

"cs-method"="POST" "sc-status" IN (200, 302) ("cs-uri-query"="*/opt/splunk/var/run/splunk/dispatch/*" "cs-uri-query"="*/shell.xsl*" "cs-uri-stem"="*/api/search/jobs*" "cs-uri-stem"="*/results*") OR ("cs-uri-query"="*NO_BINARY_CHECK=1*" "cs-uri-query"="*input.path=shell.xsl*" "cs-uri-stem"="*/splunkd/__upload/indexing/preview*")