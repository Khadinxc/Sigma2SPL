# Title: Potential Raspberry Robin CPL Execution Activity
# Author: Swachchhanda Shrawan Poudel
# Date: 2024-03-07
# Level: high
# Description: Detects the execution of a ".CPL" file located in the user temp directory via the Shell32 DLL "Control_RunDLL" export function.
# This behavior was observed in multiple Raspberry-Robin variants.
# MITRE Tactic: Defense Evasion
# Tags: attack.defense-evasion, attack.execution, attack.t1218.011, detection.emerging-threats

CommandLine="*shell32.dll*" CommandLine="*Control_RunDLL*" CommandLine="*.CPL*" Image="*\\rundll32.exe" OR OriginalFileName="RUNDLL32.EXE" ParentImage IN ("*\\rundll32.exe", "*\\control.exe") CommandLine="*\\AppData\\Local\\Temp\\*"