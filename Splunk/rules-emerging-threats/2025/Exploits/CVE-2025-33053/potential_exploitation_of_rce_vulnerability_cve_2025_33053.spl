# Title: Potential Exploitation of RCE Vulnerability CVE-2025-33053
# Author: Swachchhanda Shrawan Poudel (Nextron Systems)
# Date: 2025-06-13
# Level: high
# Description: Detects potential exploitation of remote code execution vulnerability CVE-2025-33053
# which involves unauthorized code execution via WebDAV through external control of file names or paths.
# The exploit abuses legitimate utilities like iediagcmd.exe or CustomShellHost.exe  by manipulating
# their working directories to point to attacker-controlled WebDAV servers, causing them to execute
# malicious executables (like route.exe) from the WebDAV path instead of legitimate system binaries
# through Process.Start() search order manipulation.
# MITRE Tactic: Command and Control
# Tags: attack.command-and-control, attack.execution, attack.defense-evasion, attack.t1218, attack.lateral-movement, attack.t1105, detection.emerging-threats, cve.2025-33053

CurrentDirectory="\\\\*" OR CurrentDirectory="*\\DavWWWRoot\\*" OR Image="*\\DavWWWRoot\\*" OR Image="\\\\*" Image IN ("*\\route.exe", "*\\netsh.exe", "*\\makecab.exe", "*\\dxdiag.exe", "*\\ipconfig.exe", "*\\explorer.exe") ParentImage IN ("C:\\Program Files\\internet explorer\\iediagcmd.exe", "C:\\Windows\\System32\\CustomShellHost.exe") NOT (Image IN ("C:\\Windows\\System32\\*", "C:\\Windows\\SysWOW64\\*"))