# Title: Suspicious Child Process of SAP NetWeaver - Linux
# Author: Elastic (idea), Swachchhanda Shrawan Poudel (Nextron Systems)
# Date: 2025-04-28
# Level: medium
# Description: Detects suspicious child processes spawned by SAP NetWeaver on Linux systems that could indicate potential
# exploitation of vulnerability that allows arbitrary execution via webshells such as CVE-2025-31324.
# MITRE Tactic: Execution
# Tags: attack.execution, attack.initial-access, attack.t1190, attack.persistence, attack.t1059.003, cve.2025-31324, detection.emerging-threats
# False Positives:
#   - Legitimate administrative activities such as software updates

ParentImage IN ("*/j2ee/cluster/apps/sap.com/irj/servlet_jsp/irj/work*", "*/j2ee/cluster/apps/sap.com/irj/servlet_jsp/irj/root*") OR CurrentDirectory IN ("*/j2ee/cluster/apps/sap.com/irj/servlet_jsp/irj/work*", "*/j2ee/cluster/apps/sap.com/irj/servlet_jsp/irj/root*") Image IN ("*/ash", "*/bash", "*/csh", "*/dash", "*/ksh", "*/sh", "*/tcsh", "*/zsh", "*/python", "*/python2", "*/python3", "*/perl", "*/ruby", "*/curl", "*/wget", "*/nc", "*/netcat", "*/ncat", "*/socat", "*/nmap", "*/telnet", "*/awk", "*/sed")