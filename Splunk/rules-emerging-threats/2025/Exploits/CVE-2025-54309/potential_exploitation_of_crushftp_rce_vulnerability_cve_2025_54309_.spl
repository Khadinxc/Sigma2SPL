# Title: Potential Exploitation of CrushFTP RCE Vulnerability (CVE-2025-54309)
# Author: Nisarg Suthar
# Date: 2025-08-01
# Level: high
# Description: Detects suspicious child processes created by CrushFTP. It could be an indication of exploitation of a RCE vulnerability such as CVE-2025-54309.
# MITRE Tactic: Privilege Escalation
# Tags: attack.privilege-escalation, attack.initial-access, attack.execution, attack.t1059.001, attack.t1059.003, attack.t1068, attack.t1190, cve.2025-54309, detection.emerging-threats
# False Positives:
#   - Legitimate administrative command execution

ParentImage="*\\crushftp.exe" (CommandLine IN ("*/c powershell*", "*whoami*", "*net.exe*", "*net1.exe*") Image="*\\cmd.exe") OR Image IN ("*\\bitsadmin.exe", "*\\certutil.exe", "*\\mshta.exe", "*\\cscript.exe", "*\\wscript.exe") OR (CommandLine="*IEX*" CommandLine="*enc*" CommandLine="*Hidden*" CommandLine="*bypass*" Image IN ("*\\powershell.exe", "*\\powershell_ise.exe", "*\\pwsh.exe"))