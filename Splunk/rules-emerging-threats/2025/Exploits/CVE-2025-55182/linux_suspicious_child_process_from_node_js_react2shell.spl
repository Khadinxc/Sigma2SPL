# Title: Linux Suspicious Child Process from Node.js - React2Shell
# Author: Swachchhanda Shrawan Poudel (Nextron Systems), Nasreddine Bencherchali
# Date: 2025-12-05
# Level: high
# Description: Detects suspicious child processes spawned from Node.js server processes on Linux systems, potentially indicating remote code execution exploitation such as CVE-2025-55182 (React2Shell).
# This rule particularly looks for exploitation of vulnerability on Node.js Servers where attackers abuse Node.js child_process module to execute arbitrary system commands.
# When execSync() or exec() is used, the command line often includes a shell invocation followed by suspicious commands or scripts (e.g., /bin/sh -c <malicious-command>).
# For other methods, the Image field will show the spawned process directly.
# MITRE Tactic: Execution
# Tags: attack.execution, attack.t1059, attack.initial-access, attack.t1190, detection.emerging-threats, cve.2025-55182

ParentCommandLine IN ("*--experimental-https*", "*--experimental-next-config-strip-types*", "*/node_modules/next*", "*next dev*", "*next start*", "*node_modules/.bin*", "*react-scripts start*", "*start-server.js*") ParentImage="*/node" CommandLine IN ("*/dev/tcp/*", "*/dev/udp/*", "*/etc/hosts*", "*/etc/passwd*", "*/etc/shadow*", "*base64*", "*cat *", "*curl*", "*dig*", "*ifconfig*", "*IO::Socket::INET*", "*java*", "*less *", "*lua*", "*mkfifo *", "*more*", "*nc *", "*ncat*", "*netcat*", "*netstat*", "*nslookup*", "*perl*", "*php*", "*ping*", "*ps -ef*", "*ps aux*", "*python*", "*rcat*", "*ruby*", "*sh -i 2>&1*", "*-c id*", "*socat*", "*uname*", "*wget*", "*whoami*") OR Image IN ("*/busybox", "*/cat", "*/curl", "*/dash", "*/dig", "*/head", "*/id", "*/ifconfig", "*/ip", "*/java", "*/less", "*/lua", "*/more", "*/nc", "*/ncat", "*/netcat", "*/netstat", "*/nslookup", "*/perl", "*/ping", "*/python", "*/python2", "*/ruby", "*/socat", "*/tail", "*/wget", "*/whoami") OR Image="*/python*" OR (Image="*/sh" NOT Image="*-c") OR (Image="*-c" Image="*/sh" CommandLine IN ("*/dev/tcp/*", "*/dev/udp/*", "*/etc/hosts*", "*/etc/passwd*", "*/etc/shadow*", "*base64*", "*cat *", "*curl*", "*dig*", "*ifconfig*", "*IO::Socket::INET*", "*java*", "*less *", "*lua*", "*mkfifo *", "*more*", "*nc *", "*ncat*", "*netcat*", "*netstat*", "*nslookup*", "*perl*", "*php*", "*ping*", "*ps -ef*", "*ps aux*", "*python*", "*rcat*", "*ruby*", "*sh -i 2>&1*", "*-c id*", "*socat*", "*uname*", "*wget*", "*whoami*"))