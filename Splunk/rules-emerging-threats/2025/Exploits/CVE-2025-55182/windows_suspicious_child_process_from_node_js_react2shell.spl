# Title: Windows Suspicious Child Process from Node.js - React2Shell
# Author: Swachchhanda Shrawan Poudel (Nextron Systems), Nasreddine Bencherchali
# Date: 2025-12-05
# Level: high
# Description: Detects suspicious child processes started by Node.js server processes on Windows, which may indicate exploitation of vulnerabilities like CVE-2025-55182 (React2Shell).
# Attackers can abuse the Node.js 'child_process' module to run system commands or scripts using methods such as spawn(), exec(), execFile(), fork(), or execSync().
# If execSync() or exec() is used in the exploit, the command line often shows a shell (e.g., cmd.exe /d /s /c ...) running a suspicious command unless other shells are explicitly invoked.
# For other methods, the spawned process appears directly in the Image field unless a shell is explicitly used.
# MITRE Tactic: Execution
# Tags: attack.execution, attack.t1059, attack.initial-access, attack.t1190, detection.emerging-threats, cve.2025-55182

ParentCommandLine IN ("*--experimental-https*", "*--experimental-next-config-strip-types*", "*\\node_modules\\next*", "*next dev*", "*next start*", "*next\" start*", "*node_modules\\.bin\\\\..\\next*", "*react-scripts start*", "*start-server.js*") ParentImage="*\\node.exe" CommandLine IN ("*\\net*", "*bitsadmin*", "*certutil *", "*conhost --headless*", "*cscript *", "*curl*", "*ipconfig*", "*java*", "*lua*", "*mshta*", "*netsh*", "*nslookup *", "*perl*", "*ping *", "*powershell*", "*pwsh*", "*python*", "*reg *", "*reg.exe*", "*regsvr32*", "*ruby*", "*rundll32*", "*sc.exe*", "*systeminfo*", "*wget*", "*whoami*", "*wmic*", "*wscript*") OR Image IN ("*\\bash.exe", "*\\bitsadmin.exe", "*\\certutil.exe", "*\\cscript.exe", "*\\curl.exe", "*\\ipconfig.exe", "*\\mshta.exe", "*\\net.exe", "*\\net1.exe", "*\\netsh.exe", "*\\nslookup.exe", "*\\OpenConsole.exe", "*\\perl.exe", "*\\ping.exe", "*\\powershell.exe", "*\\pwsh.exe", "*\\py.exe", "*\\python.exe", "*\\pythonw.exe", "*\\pyw.exe", "*\\reg.exe", "*\\regsvr32.exe", "*\\rundll32.exe", "*\\sc.exe", "*\\sh.exe", "*\\systeminfo.exe", "*\\wget.exe", "*\\whoami.exe", "*\\wmic.exe", "*\\wscript.exe", "*\\wt.exe") OR Image="*\\python*" OR (Image="*\\cmd.exe" NOT CommandLine="*/d /s /c *") OR (CommandLine="*/d /s /c *" Image="*\\cmd.exe" NOT (CommandLine="*git config --local --get remote.origin.url*" OR (CommandLine="*\\mkcert\\*" CommandLine="* -CAROOT*") OR (CommandLine="*\\mkcert\\*" CommandLine="* -install *") OR (CommandLine="*netstat -ano | findstr /C:*" CommandLine="* | findstr LISTENING*")))