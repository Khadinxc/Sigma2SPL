# Title: Potential CVE-2023-25157 Exploitation Attempt
# Author: Nasreddine Bencherchali (Nextron Systems)
# Date: 2023-06-14
# Level: high
# Description: Detects a potential exploitation attempt of CVE-2023-25157 a SQL injection in GeoServer
# MITRE Tactic: Initial Access
# Tags: attack.initial-access, cve.2023-25157, detection.emerging-threats
# False Positives:
#   - Vulnerability scanners

"cs-uri-query" IN ("*+--*", "*+AS+*", "*+OR+*", "*FROM*", "*ORDER+BY*", "*SELECT*", "*sleep%28*", "*substring%28*", "*UNION*", "*WHERE*") "cs-method"="GET" "cs-uri-query" IN ("*PropertyIsLike*", "*strEndsWith*", "*strStartsWith*", "*FeatureId*", "*jsonArrayContains*", "*DWithin*") "cs-uri-query"="*/geoserver/ows*" "cs-uri-query"="*CQL_FILTER=*"