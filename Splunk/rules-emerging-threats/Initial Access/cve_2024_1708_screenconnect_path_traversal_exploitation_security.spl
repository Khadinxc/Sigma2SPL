# Title: CVE-2024-1708 - ScreenConnect Path Traversal Exploitation - Security
# Author: Matt Anderson, Caleb Stewart, Huntress
# Date: 2024-02-20
# Level: critical
# Description: This detects file modifications to ASPX and ASHX files within the root of the App_Extensions directory, which is allowed by a ZipSlip vulnerability in versions prior to 23.9.8. This occurs during exploitation of CVE-2024-1708.
# This requires an Advanced Auditing policy to log a successful Windows Event ID 4663 events and with a SACL set on the directory.
# MITRE Tactic: Initial Access
# Tags: attack.initial-access, attack.persistence, cve.2024-1708, detection.emerging-threats

AccessMask="0x6" EventID=4663 ObjectName IN ("*ScreenConnect\\App_Extensions\\*.ashx", "*ScreenConnect\\App_Extensions\\*.aspx") ObjectType="File" ProcessName="*ScreenConnect.Service.exe*" NOT ObjectName="*ScreenConnect\\App_Extensions\\*\\*"