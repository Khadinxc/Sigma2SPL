# Title: Potential MOVEit Transfer CVE-2023-34362 Exploitation - File Activity
# Author: Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)
# Date: 2023-06-01
# Level: high
# Description: Detects file indicators of potential exploitation of MOVEit CVE-2023-34362.
# MITRE Tactic: Initial Access
# Tags: attack.initial-access, attack.t1190, cve.2023-34362, detection.emerging-threats
# False Positives:
#   - To avoid FP, this rule should only be applied on MOVEit servers.

(CreationUtcTime IN ("2023-03- *", "2023-04- *", "2023-05- *", "2023-06- *") TargetFilename="*\\Windows\\Microsoft.net\\Framework64\\v*" TargetFilename="*\\Temporary ASP.NET Files\\*" TargetFilename="*App_Web_*" TargetFilename="*.dll") OR (TargetFilename IN ("*\\MOVEit Transfer\\wwwroot\\*", "*\\MOVEitTransfer\\wwwroot\\*") TargetFilename IN ("*.7z", "*.bat", "*.dll", "*.exe", "*.ps1", "*.rar", "*.vbe", "*.vbs", "*.zip")) OR TargetFilename IN ("*\\MOVEit Transfer\\wwwroot\\_human2.aspx.lnk", "*\\MOVEit Transfer\\wwwroot\\_human2.aspx", "*\\MOVEit Transfer\\wwwroot\\human2.aspx.lnk", "*\\MOVEit Transfer\\wwwroot\\human2.aspx", "*\\MOVEitTransfer\\wwwroot\\_human2.aspx.lnk", "*\\MOVEitTransfer\\wwwroot\\_human2.aspx", "*\\MOVEitTransfer\\wwwroot\\human2.aspx.lnk", "*\\MOVEitTransfer\\wwwroot\\human2.aspx")