# Title: Potential SAP NetWeaver Webshell Creation - Linux
# Author: Elastic (idea), Swachchhanda Shrawan Poudel (Nextron Systems)
# Date: 2025-04-28
# Level: medium
# Description: Detects the creation of suspicious files (jsp, java, class) in SAP NetWeaver directories,
# which may indicate exploitation attempts of vulnerabilities such as CVE-2025-31324.
# MITRE Tactic: Execution
# Tags: attack.execution, attack.initial-access, attack.t1190, attack.persistence, attack.t1059.003, cve.2025-31324, detection.emerging-threats
# False Positives:
#   - Legitimate creation of jsc or java files in these locations

TargetFilename IN ("*.jsp", "*.java", "*.class") TargetFilename IN ("*/j2ee/cluster/apps/sap.com/irj/servlet_jsp/irj/work/*", "*/j2ee/cluster/apps/sap.com/irj/servlet_jsp/irj/root/*")