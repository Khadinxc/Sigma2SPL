# Title: Blackbyte Ransomware Registry
# Author: frack113
# Date: 2022-01-24
# Level: high
# Description: Detects specific windows registry modifications made by BlackByte ransomware variants.
# BlackByte set three different registry values to escalate privileges and begin setting the stage for lateral movement and encryption.
# This rule triggers when any of the following registry keys are set to DWORD 1, however all three should be investigated as part of a larger BlackByte ransomware detection and response effort.
# MITRE Tactic: Persistence
# Tags: attack.persistence, attack.defense-evasion, attack.t1112, detection.emerging-threats

Details="DWORD (0x00000001)" TargetObject IN ("HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LocalAccountTokenFilterPolicy", "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\EnableLinkedConnections", "HKLM\\SYSTEM\\CurrentControlSet\\Control\\FileSystem\\LongPathsEnabled")