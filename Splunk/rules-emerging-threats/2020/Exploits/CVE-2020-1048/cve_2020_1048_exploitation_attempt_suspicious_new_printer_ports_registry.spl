# Title: CVE-2020-1048 Exploitation Attempt - Suspicious New Printer Ports - Registry
# Author: EagleEye Team, Florian Roth (Nextron Systems), NVISO
# Date: 2020-05-13
# Level: high
# Description: Detects changes to the "Ports" registry key with data that includes a Windows path or a file with a suspicious extension.
# This could be an attempt to exploit CVE-2020-1048 - a Windows Print Spooler elevation of privilege vulnerability.
# MITRE Tactic: Persistence
# Tags: attack.persistence, attack.execution, attack.defense-evasion, attack.t1112, cve.2020-1048, detection.emerging-threats
# False Positives:
#   - New printer port install on host

Details IN ("*.bat*", "*.com*", "*.dll*", "*.exe*", "*.ps1*", "*.vbe*", "*.vbs*", "*C:*") TargetObject="*\\Microsoft\\Windows NT\\CurrentVersion\\Ports*"