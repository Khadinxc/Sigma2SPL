# Title: Access To Browser Credential Files By Uncommon Applications - Security
# Author: Daniel Koifman (@Koifsec), Nasreddine Bencherchali
# Date: 2024-10-21
# Level: low
# Description: Detects file access requests to browser credential stores by uncommon processes. Could indicate potential attempt of credential stealing This rule requires heavy baselining before usage.
# MITRE Tactic: Credential Access
# Tags: attack.credential-access, attack.t1555.003, detection.threat-hunting

AccessMask="0x1" EventID=4663 ObjectType="File" ObjectName IN ("*\\User Data\\Default\\Login Data*", "*\\User Data\\Local State*", "*\\User Data\\Default\\Network\\Cookies*") OR FileName IN ("*\\cookies.sqlite", "*\\places.sqlite", "*release\\key3.db", "*release\\key4.db", "*release\\logins.json") NOT (ProcessName IN ("C:\\Program Files (x86)\\*", "C:\\Program Files\\*", "C:\\Windows\\system32\\*", "C:\\Windows\\SysWOW64\\*") OR ProcessName="System") NOT (ProcessName IN ("*\\MpCopyAccelerator.exe", "*\\MsMpEng.exe") ProcessName="C:\\ProgramData\\Microsoft\\Windows Defender\\*")