# Title: Shell Execution via Flock - Linux
# Author: Li Ling, Andy Parkidomo, Robert Rakowski, Blake Hartstein (Bloomberg L.P.)
# Date: 2024-09-02
# Level: high
# Description: Detects the use of the "flock" command to execute a shell. Such behavior may be associated with privilege escalation, unauthorized command execution, or to break out from restricted environments.
# MITRE Tactic: Discovery
# Tags: attack.discovery, attack.t1083

CommandLine IN ("*/bin/bash*", "*/bin/dash*", "*/bin/fish*", "*/bin/sh*", "*/bin/zsh*") CommandLine="* -u *" Image="*/flock"