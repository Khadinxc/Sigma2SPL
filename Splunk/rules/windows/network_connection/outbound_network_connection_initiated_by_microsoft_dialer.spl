# Title: Outbound Network Connection Initiated By Microsoft Dialer
# Author: CertainlyP
# Date: 2024-04-26
# Level: high
# Description: Detects outbound network connection initiated by Microsoft Dialer.
# The Microsoft Dialer, also known as Phone Dialer, is a built-in utility application included in various versions of the Microsoft Windows operating system. Its primary function is to provide users with a graphical interface for managing phone calls via a modem or a phone line connected to the computer.
# This is an outdated process in the current conext of it's usage and is a common target for info stealers for process injection, and is used to make C2 connections, common example is "Rhadamanthys"
# MITRE Tactic: Execution
# Tags: attack.execution, attack.command-and-control, attack.t1071.001
# False Positives:
#   - In Modern Windows systems, unable to see legitimate usage of this process, However, if an organization has legitimate purpose for this there can be false positives.

Image="*:\\Windows\\System32\\dialer.exe" Initiated="true" NOT (DestinationIp="127.0.0.0/8" OR DestinationIp="10.0.0.0/8" OR DestinationIp="172.16.0.0/12" OR DestinationIp="192.168.0.0/16" OR DestinationIp="169.254.0.0/16" OR DestinationIp="::1/128" OR DestinationIp="fe80::/10" OR DestinationIp="fc00::/7")