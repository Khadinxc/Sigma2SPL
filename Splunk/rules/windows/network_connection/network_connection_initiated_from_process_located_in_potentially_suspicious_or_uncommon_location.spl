# Title: Network Connection Initiated From Process Located In Potentially Suspicious Or Uncommon Location
# Author: Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)
# Date: 2017-03-19
# Level: high
# Description: Detects a network connection initiated by programs or processes running from suspicious or uncommon files system locations.
# MITRE Tactic: Command and Control
# Tags: attack.command-and-control, attack.t1105

Image IN ("*:\\$Recycle.bin*", "*:\\Perflogs\\*", "*:\\Temp\\*", "*:\\Users\\Default\\*", "*:\\Users\\Public\\*", "*:\\Windows\\Fonts\\*", "*:\\Windows\\IME\\*", "*:\\Windows\\System32\\Tasks\\*", "*:\\Windows\\Tasks\\*", "*\\config\\systemprofile\\*", "*\\Contacts\\*", "*\\Favorites\\*", "*\\Favourites\\*", "*\\Music\\*", "*\\Pictures\\*", "*\\Videos\\*", "*\\Windows\\addins\\*") Initiated="true" NOT (DestinationHostname IN ("*.githubusercontent.com", "*anonfiles.com", "*cdn.discordapp.com", "*ddns.net", "*dl.dropboxusercontent.com", "*ghostbin.co", "*github.com", "*glitch.me", "*gofile.io", "*hastebin.com", "*mediafire.com", "*mega.co.nz", "*mega.nz", "*onrender.com", "*pages.dev", "*paste.ee", "*pastebin.com", "*pastebin.pl", "*pastetext.net", "*portmap.io", "*privatlab.com", "*privatlab.net", "*send.exploit.in", "*sendspace.com", "*storage.googleapis.com", "*storjshare.io", "*supabase.co", "*temp.sh", "*transfer.sh", "*trycloudflare.com", "*ufile.io", "*w3spaces.com", "*workers.dev"))