# Title: Invoke-Obfuscation Via Use Rundll32 - System
# Author: Nikita Nazarov, oscd.community
# Date: 2020-10-09
# Level: high
# Description: Detects Obfuscated Powershell via use Rundll32 in Scripts
# MITRE Tactic: Defense Evasion
# Tags: attack.defense-evasion, attack.t1027, attack.execution, attack.t1059.001

EventID=7045 ImagePath IN ("*value*", "*invoke*", "*comspec*", "*iex*") ImagePath="*&&*" ImagePath="*rundll32*" ImagePath="*shell32.dll*" ImagePath="*shellexec_rundll*" Provider_Name="Service Control Manager"