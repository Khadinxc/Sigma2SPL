# Title: Third Party Software DLL Sideloading
# Author: Nasreddine Bencherchali (Nextron Systems), Wietze Beukema (project and research)
# Date: 2022-08-17
# Level: medium
# Description: Detects DLL sideloading of DLLs that are part of third party software (zoom, discord....etc)
# MITRE Tactic: Defense Evasion
# Tags: attack.defense-evasion, attack.persistence, attack.privilege-escalation, attack.t1574.001

(ImageLoaded="*\\commfunc.dll" NOT (ImageLoaded="*\\AppData\\local\\Google\\Chrome\\Application\\*" OR ImageLoaded IN ("C:\\Program Files\\Lenovo\\Communications Utility\\*", "C:\\Program Files (x86)\\Lenovo\\Communications Utility\\*"))) OR (ImageLoaded="*\\tosbtkbd.dll" NOT (ImageLoaded IN ("C:\\Program Files\\Toshiba\\Bluetooth Toshiba Stack\\*", "C:\\Program Files (x86)\\Toshiba\\Bluetooth Toshiba Stack\\*")))