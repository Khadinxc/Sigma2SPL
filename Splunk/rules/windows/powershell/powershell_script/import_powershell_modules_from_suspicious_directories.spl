# Title: Import PowerShell Modules From Suspicious Directories
# Author: Nasreddine Bencherchali (Nextron Systems)
# Date: 2022-07-07
# Level: medium
# Description: Detects powershell scripts that import modules from suspicious directories
# MITRE Tactic: Execution
# Tags: attack.execution, attack.t1059.001

ScriptBlockText IN ("*Import-Module \"$Env:Temp\\*", "*Import-Module '$Env:Temp\\*", "*Import-Module $Env:Temp\\*", "*Import-Module \"$Env:Appdata\\*", "*Import-Module '$Env:Appdata\\*", "*Import-Module $Env:Appdata\\*", "*Import-Module C:\\Users\\Public\\*", "*ipmo \"$Env:Temp\\*", "*ipmo '$Env:Temp\\*", "*ipmo $Env:Temp\\*", "*ipmo \"$Env:Appdata\\*", "*ipmo '$Env:Appdata\\*", "*ipmo $Env:Appdata\\*", "*ipmo C:\\Users\\Public\\*")