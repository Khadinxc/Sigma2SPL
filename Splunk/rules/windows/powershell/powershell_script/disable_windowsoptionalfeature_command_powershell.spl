# Title: Disable-WindowsOptionalFeature Command PowerShell
# Author: frack113
# Date: 2022-09-10
# Level: high
# Description: Detect built in PowerShell cmdlet Disable-WindowsOptionalFeature, Deployment Image Servicing and Management tool.
# Similar to DISM.exe, this cmdlet is used to enumerate, install, uninstall, configure, and update features and packages in Windows images
# MITRE Tactic: Defense Evasion
# Tags: attack.defense-evasion, attack.t1562.001

ScriptBlockText="*Disable-WindowsOptionalFeature*" ScriptBlockText="*-Online*" ScriptBlockText="*-FeatureName*" ScriptBlockText IN ("*Windows-Defender-Gui*", "*Windows-Defender-Features*", "*Windows-Defender*", "*Windows-Defender-ApplicationGuard*")