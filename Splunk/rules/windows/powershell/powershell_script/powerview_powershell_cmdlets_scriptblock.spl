# Title: PowerView PowerShell Cmdlets - ScriptBlock
# Author: Bhabesh Raj
# Date: 2021-05-18
# Level: high
# Description: Detects Cmdlet names from PowerView of the PowerSploit exploitation framework.
# MITRE Tactic: Execution
# Tags: attack.execution, attack.t1059.001

ScriptBlockText IN ("*Export-PowerViewCSV*", "*Find-DomainLocalGroupMember*", "*Find-DomainObjectPropertyOutlier*", "*Find-DomainProcess*", "*Find-DomainShare*", "*Find-DomainUserEvent*", "*Find-DomainUserLocation*", "*Find-ForeignGroup*", "*Find-ForeignUser*", "*Find-GPOComputerAdmin*", "*Find-GPOLocation*", "*Find-InterestingDomain*", "*Find-InterestingFile*", "*Find-LocalAdminAccess*", "*Find-ManagedSecurityGroups*", "*Get-CachedRDPConnection*", "*Get-DFSshare*", "*Get-DomainDFSShare*", "*Get-DomainDNSRecord*", "*Get-DomainDNSZone*", "*Get-DomainFileServer*", "*Get-DomainGPOComputerLocalGroupMapping*", "*Get-DomainGPOLocalGroup*", "*Get-DomainGPOUserLocalGroupMapping*", "*Get-LastLoggedOn*", "*Get-LoggedOnLocal*", "*Get-NetFileServer*", "*Get-NetForest*", "*Get-NetGPOGroup*", "*Get-NetProcess*", "*Get-NetRDPSession*", "*Get-RegistryMountedDrive*", "*Get-RegLoggedOn*", "*Get-WMIRegCachedRDPConnection*", "*Get-WMIRegLastLoggedOn*", "*Get-WMIRegMountedDrive*", "*Get-WMIRegProxy*", "*Invoke-ACLScanner*", "*Invoke-CheckLocalAdminAccess*", "*Invoke-EnumerateLocalAdmin*", "*Invoke-EventHunter*", "*Invoke-FileFinder*", "*Invoke-Kerberoast*", "*Invoke-MapDomainTrust*", "*Invoke-ProcessHunter*", "*Invoke-RevertToSelf*", "*Invoke-ShareFinder*", "*Invoke-UserHunter*", "*Invoke-UserImpersonation*", "*Remove-RemoteConnection*", "*Request-SPNTicket*", "*Resolve-IPAddress*")