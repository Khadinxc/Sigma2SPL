# Title: Potential Arbitrary Command Execution Using Msdt.EXE
# Author: Nasreddine Bencherchali (Nextron Systems)
# Date: 2022-05-29
# Level: high
# Description: Detects processes leveraging the "ms-msdt" handler or the "msdt.exe" binary to execute arbitrary commands as seen in the follina (CVE-2022-30190) vulnerability
# MITRE Tactic: Defense Evasion
# Tags: attack.defense-evasion, attack.t1202

Image="*\\msdt.exe" OR OriginalFileName="msdt.exe" CommandLine="*IT_BrowseForFile=*" OR (CommandLine="* PCWDiagnostic*" CommandLine="* -af *" OR CommandLine="* /af *" OR CommandLine="* –af *" OR CommandLine="* —af *" OR CommandLine="* ―af *")