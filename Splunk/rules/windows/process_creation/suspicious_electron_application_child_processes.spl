# Title: Suspicious Electron Application Child Processes
# Author: Nasreddine Bencherchali (Nextron Systems)
# Date: 2022-10-21
# Level: medium
# Description: Detects suspicious child processes of electron apps (teams, discord, slack, etc.). This could be a potential sign of ".asar" file tampering (See reference section for more information) or binary execution proxy through specific CLI arguments (see related rule)
# MITRE Tactic: Execution
# Tags: attack.execution

ParentImage IN ("*\\chrome.exe", "*\\discord.exe", "*\\GitHubDesktop.exe", "*\\keybase.exe", "*\\msedge.exe", "*\\msedgewebview2.exe", "*\\msteams.exe", "*\\slack.exe", "*\\teams.exe") Image IN ("*\\cmd.exe", "*\\cscript.exe", "*\\mshta.exe", "*\\powershell.exe", "*\\pwsh.exe", "*\\regsvr32.exe", "*\\whoami.exe", "*\\wscript.exe") OR Image IN ("*:\\ProgramData\\*", "*:\\Temp\\*", "*\\AppData\\Local\\Temp\\*", "*\\Users\\Public\\*", "*\\Windows\\Temp\\*") NOT (CommandLine="*\\NVSMI\\nvidia-smi.exe*" Image="*\\cmd.exe" ParentImage="*\\Discord.exe")