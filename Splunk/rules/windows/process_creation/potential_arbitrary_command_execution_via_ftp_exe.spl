# Title: Potential Arbitrary Command Execution Via FTP.EXE
# Author: Victor Sergeev, oscd.community
# Date: 2020-10-09
# Level: medium
# Description: Detects execution of "ftp.exe" script with the "-s" or "/s" flag and any child processes ran by "ftp.exe".
# MITRE Tactic: Execution
# Tags: attack.execution, attack.t1059, attack.defense-evasion, attack.t1202

ParentImage="*\\ftp.exe" OR (CommandLine="*-s:*" OR CommandLine="*/s:*" OR CommandLine="*–s:*" OR CommandLine="*—s:*" OR CommandLine="*―s:*" Image="*\\ftp.exe" OR OriginalFileName="ftp.exe")