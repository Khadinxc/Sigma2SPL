# Title: Potentially Suspicious Regsvr32 HTTP IP Pattern
# Author: Florian Roth (Nextron Systems)
# Date: 2022-01-11
# Level: high
# Description: Detects regsvr32 execution to download and install DLLs located remotely where the address is an IP address.
# MITRE Tactic: Defense Evasion
# Tags: attack.defense-evasion, attack.t1218.010
# False Positives:
#   - FQDNs that start with a number such as "7-Zip"

Image="*\\regsvr32.exe" OR OriginalFileName="REGSVR32.EXE" CommandLine IN ("* /i:http://1*", "* /i:http://2*", "* /i:http://3*", "* /i:http://4*", "* /i:http://5*", "* /i:http://6*", "* /i:http://7*", "* /i:http://8*", "* /i:http://9*", "* /i:https://1*", "* /i:https://2*", "* /i:https://3*", "* /i:https://4*", "* /i:https://5*", "* /i:https://6*", "* /i:https://7*", "* /i:https://8*", "* /i:https://9*", "* -i:http://1*", "* -i:http://2*", "* -i:http://3*", "* -i:http://4*", "* -i:http://5*", "* -i:http://6*", "* -i:http://7*", "* -i:http://8*", "* -i:http://9*", "* -i:https://1*", "* -i:https://2*", "* -i:https://3*", "* -i:https://4*", "* -i:https://5*", "* -i:https://6*", "* -i:https://7*", "* -i:https://8*", "* -i:https://9*")