# Title: Allow Service Access Using Security Descriptor Tampering Via Sc.EXE
# Author: Nasreddine Bencherchali (Nextron Systems)
# Date: 2023-02-28
# Level: high
# Description: Detects suspicious DACL modifications to allow access to a service from a suspicious trustee. This can be used to override access restrictions set by previous ACLs.
# MITRE Tactic: Privilege Escalation
# Tags: attack.privilege-escalation, attack.persistence, attack.t1543.003

Image="*\\sc.exe" OR OriginalFileName="sc.exe" CommandLine="*sdset*" CommandLine="*A;*" CommandLine IN ("*;IU*", "*;SU*", "*;BA*", "*;SY*", "*;WD*") NOT ParentImage="C:\\Hexnode\\Hexnode Agent\\Current\\HexnodeAgent.exe"