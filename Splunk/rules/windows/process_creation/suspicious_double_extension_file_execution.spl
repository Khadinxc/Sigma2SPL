# Title: Suspicious Double Extension File Execution
# Author: Florian Roth (Nextron Systems), @blu3_team (idea), Nasreddine Bencherchali (Nextron Systems)
# Date: 2019-06-26
# Level: high
# Description: Detects suspicious use of an .exe extension after a non-executable file extension like .pdf.exe, a set of spaces or underlines to cloak the executable file in spear phishing campaigns
# MITRE Tactic: Initial Access
# Tags: attack.initial-access, attack.t1566.001

CommandLine IN ("*      .exe*", "*______.exe*", "*.doc.exe*", "*.doc.js*", "*.docx.exe*", "*.docx.js*", "*.gif.exe*", "*.jpeg.exe*", "*.jpg.exe*", "*.mkv.exe*", "*.mov.exe*", "*.mp3.exe*", "*.mp4.exe*", "*.pdf.exe*", "*.pdf.js*", "*.png.exe*", "*.ppt.exe*", "*.ppt.js*", "*.pptx.exe*", "*.pptx.js*", "*.rtf.exe*", "*.rtf.js*", "*.svg.exe*", "*.txt.exe*", "*.txt.js*", "*.xls.exe*", "*.xls.js*", "*.xlsx.exe*", "*.xlsx.js*", "*⠀⠀⠀⠀⠀⠀.exe*") Image IN ("*      .exe", "*______.exe", "*.doc.exe", "*.doc.js", "*.docx.exe", "*.docx.js", "*.gif.exe", "*.jpeg.exe", "*.jpg.exe", "*.mkv.exe", "*.mov.exe", "*.mp3.exe", "*.mp4.exe", "*.pdf.exe", "*.pdf.js", "*.png.exe", "*.ppt.exe", "*.ppt.js", "*.pptx.exe", "*.pptx.js", "*.rtf.exe", "*.rtf.js", "*.svg.exe", "*.txt.exe", "*.txt.js", "*.xls.exe", "*.xls.js", "*.xlsx.exe", "*.xlsx.js", "*⠀⠀⠀⠀⠀⠀.exe")