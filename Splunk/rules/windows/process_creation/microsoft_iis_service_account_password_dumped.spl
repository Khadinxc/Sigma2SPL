# Title: Microsoft IIS Service Account Password Dumped
# Author: Tim Rauch, Janantha Marasinghe, Elastic (original idea)
# Date: 2022-11-08
# Level: high
# Description: Detects the Internet Information Services (IIS) command-line tool, AppCmd, being used to list passwords
# MITRE Tactic: Credential Access
# Tags: attack.credential-access, attack.t1003

CommandLine="*list *" Image="*\\appcmd.exe" OR OriginalFileName="appcmd.exe" CommandLine IN ("* /config*", "* /xml*", "* -config*", "* -xml*") OR (CommandLine IN ("* /@t*", "* /text*", "* /show*", "* -@t*", "* -text*", "* -show*") CommandLine IN ("*:\**", "*password*"))