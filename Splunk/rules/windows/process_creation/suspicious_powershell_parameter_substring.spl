# Title: Suspicious PowerShell Parameter Substring
# Author: Florian Roth (Nextron Systems), Daniel Bohannon (idea), Roberto Rodriguez (Fix)
# Date: 2019-01-16
# Level: high
# Description: Detects suspicious PowerShell invocation with a parameter substring
# MITRE Tactic: Execution
# Tags: attack.execution, attack.t1059.001

CommandLine IN ("* -windowstyle h *", "* -windowstyl h*", "* -windowsty h*", "* -windowst h*", "* -windows h*", "* -windo h*", "* -wind h*", "* -win h*", "* -wi h*", "* -win h *", "* -win hi *", "* -win hid *", "* -win hidd *", "* -win hidde *", "* -NoPr *", "* -NoPro *", "* -NoProf *", "* -NoProfi *", "* -NoProfil *", "* -nonin *", "* -nonint *", "* -noninte *", "* -noninter *", "* -nonintera *", "* -noninterac *", "* -noninteract *", "* -noninteracti *", "* -noninteractiv *", "* -ec *", "* -encodedComman *", "* -encodedComma *", "* -encodedComm *", "* -encodedCom *", "* -encodedCo *", "* -encodedC *", "* -encoded *", "* -encode *", "* -encod *", "* -enco *", "* -en *", "* -executionpolic *", "* -executionpoli *", "* -executionpol *", "* -executionpo *", "* -executionp *", "* -execution bypass*", "* -executio bypass*", "* -executi bypass*", "* -execut bypass*", "* -execu bypass*", "* -exec bypass*", "* -exe bypass*", "* -ex bypass*", "* -ep bypass*", "* /windowstyle h *", "* /windowstyl h*", "* /windowsty h*", "* /windowst h*", "* /windows h*", "* /windo h*", "* /wind h*", "* /win h*", "* /wi h*", "* /win h *", "* /win hi *", "* /win hid *", "* /win hidd *", "* /win hidde *", "* /NoPr *", "* /NoPro *", "* /NoProf *", "* /NoProfi *", "* /NoProfil *", "* /nonin *", "* /nonint *", "* /noninte *", "* /noninter *", "* /nonintera *", "* /noninterac *", "* /noninteract *", "* /noninteracti *", "* /noninteractiv *", "* /ec *", "* /encodedComman *", "* /encodedComma *", "* /encodedComm *", "* /encodedCom *", "* /encodedCo *", "* /encodedC *", "* /encoded *", "* /encode *", "* /encod *", "* /enco *", "* /en *", "* /executionpolic *", "* /executionpoli *", "* /executionpol *", "* /executionpo *", "* /executionp *", "* /execution bypass*", "* /executio bypass*", "* /executi bypass*", "* /execut bypass*", "* /execu bypass*", "* /exec bypass*", "* /exe bypass*", "* /ex bypass*", "* /ep bypass*") Image IN ("*\\powershell.exe", "*\\pwsh.exe")