# Title: Invoke-Obfuscation Via Use MSHTA
# Author: Nikita Nazarov, oscd.community
# Date: 2020-10-08
# Level: high
# Description: Detects Obfuscated Powershell via use MSHTA in Scripts
# MITRE Tactic: Defense Evasion
# Tags: attack.defense-evasion, attack.t1027, attack.execution, attack.t1059.001

CommandLine="*set*" CommandLine="*&&*" CommandLine="*mshta*" CommandLine="*vbscript:createobject*" CommandLine="*.run*" CommandLine="*(window.close)*"