# Title: Potentially Suspicious File Download From File Sharing Domain Via PowerShell.EXE
# Author: Nasreddine Bencherchali (Nextron Systems)
# Date: 2024-02-23
# Level: high
# Description: Detects potentially suspicious file downloads from file sharing domains using PowerShell.exe
# MITRE Tactic: Execution
# Tags: attack.execution

CommandLine IN ("*.DownloadString(*", "*.DownloadFile(*", "*Invoke-WebRequest *", "*iwr *", "*wget *") Image IN ("*\\powershell.exe", "*\\pwsh.exe") OR OriginalFileName IN ("PowerShell.EXE", "pwsh.dll") CommandLine IN ("*anonfiles.com*", "*cdn.discordapp.com*", "*ddns.net*", "*dl.dropboxusercontent.com*", "*ghostbin.co*", "*glitch.me*", "*gofile.io*", "*hastebin.com*", "*mediafire.com*", "*mega.nz*", "*onrender.com*", "*pages.dev*", "*paste.ee*", "*pastebin.com*", "*pastebin.pl*", "*pastetext.net*", "*pixeldrain.com*", "*privatlab.com*", "*privatlab.net*", "*send.exploit.in*", "*sendspace.com*", "*storage.googleapis.com*", "*storjshare.io*", "*supabase.co*", "*temp.sh*", "*transfer.sh*", "*trycloudflare.com*", "*ufile.io*", "*w3spaces.com*", "*workers.dev*")