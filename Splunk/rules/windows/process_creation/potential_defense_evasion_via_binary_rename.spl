# Title: Potential Defense Evasion Via Binary Rename
# Author: Matthew Green @mgreen27, Ecco, James Pemberton @4A616D6573, oscd.community, Andreas Hunkeler (@Karneades)
# Date: 2019-06-15
# Level: medium
# Description: Detects the execution of a renamed binary often used by attackers or malware leveraging new Sysmon OriginalFileName datapoint.
# MITRE Tactic: Defense Evasion
# Tags: attack.defense-evasion, attack.t1036.003
# False Positives:
#   - Custom applications use renamed binaries adding slight change to binary name. Typically this is easy to spot and add to whitelist

OriginalFileName IN ("Cmd.Exe", "CONHOST.EXE", "7z.exe", "7za.exe", "WinRAR.exe", "wevtutil.exe", "net.exe", "net1.exe", "netsh.exe", "InstallUtil.exe") NOT (Image IN ("*\\cmd.exe", "*\\conhost.exe", "*\\7z.exe", "*\\7za.exe", "*\\WinRAR.exe", "*\\wevtutil.exe", "*\\net.exe", "*\\net1.exe", "*\\netsh.exe", "*\\InstallUtil.exe"))