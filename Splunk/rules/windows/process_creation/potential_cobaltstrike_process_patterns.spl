# Title: Potential CobaltStrike Process Patterns
# Author: Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)
# Date: 2021-07-27
# Level: high
# Description: Detects potential process patterns related to Cobalt Strike beacon activity
# MITRE Tactic: Execution
# Tags: attack.execution, attack.t1059

(CommandLine="*conhost.exe 0xffffffff -ForceV1" ParentCommandLine="*cmd.exe /C echo*" ParentCommandLine="* > \\\\.\\pipe*") OR (CommandLine="*conhost.exe 0xffffffff -ForceV1" ParentCommandLine="*/C whoami") OR (CommandLine="*cmd.exe /C whoami" ParentImage="C:\\Temp\\*") OR (CommandLine="*cmd.exe /c echo*" CommandLine="*> \\\\.\\pipe*" ParentImage IN ("*\\runonce.exe", "*\\dllhost.exe"))