# Title: Potential Mpclient.DLL Sideloading Via OfflineScannerShell.EXE Execution
# Author: frack113
# Date: 2022-03-06
# Level: medium
# Description: Detects execution of Windows Defender "OfflineScannerShell.exe" from its non standard directory.
# The "OfflineScannerShell.exe" binary is vulnerable to DLL side loading and will load any DLL named "mpclient.dll" from the current working directory.
# MITRE Tactic: Defense Evasion
# Tags: attack.defense-evasion, attack.t1218

Image="*\\OfflineScannerShell.exe" OR OriginalFileName="OfflineScannerShell.exe" NOT (CurrentDirectory="" OR CurrentDirectory="C:\\Program Files\\Windows Defender\\Offline\\" OR NOT CurrentDirectory=*)