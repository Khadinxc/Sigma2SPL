# Title: LSASS Process Reconnaissance Via Findstr.EXE
# Author: Florian Roth (Nextron Systems)
# Date: 2022-08-12
# Level: high
# Description: Detects findstring commands that include the keyword lsass, which indicates recon actviity for the LSASS process PID
# MITRE Tactic: Credential Access
# Tags: attack.credential-access, attack.t1552.006

(CommandLine="*lsass*" Image IN ("*\\find.exe", "*\\findstr.exe") OR OriginalFileName IN ("FIND.EXE", "FINDSTR.EXE")) OR CommandLine="* -i \"lsass*" OR CommandLine="* /i \"lsass*" OR CommandLine="* –i \"lsass*" OR CommandLine="* —i \"lsass*" OR CommandLine="* ―i \"lsass*" OR CommandLine="* -i lsass.exe*" OR CommandLine="* /i lsass.exe*" OR CommandLine="* –i lsass.exe*" OR CommandLine="* —i lsass.exe*" OR CommandLine="* ―i lsass.exe*" OR CommandLine="*findstr \"lsass*" OR CommandLine="*findstr lsass*" OR CommandLine="*findstr.exe \"lsass*" OR CommandLine="*findstr.exe lsass*"