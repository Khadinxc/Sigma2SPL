# Title: Obfuscated PowerShell OneLiner Execution
# Author: @Kostastsale, TheDFIRReport
# Date: 2022-05-09
# Level: high
# Description: Detects the execution of a specific OneLiner to download and execute powershell modules in memory.
# MITRE Tactic: Defense Evasion
# Tags: attack.defense-evasion, attack.execution, attack.t1059.001, attack.t1562.001

CommandLine="*http://127.0.0.1*" CommandLine="*%{(IRM $_)}*" CommandLine="*Invoke*" Image="*\\powershell.exe"