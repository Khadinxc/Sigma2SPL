# Title: Suspicious Child Process Of BgInfo.EXE
# Author: Nasreddine Bencherchali (Nextron Systems)
# Date: 2023-08-16
# Level: high
# Description: Detects suspicious child processes of "BgInfo.exe" which could be a sign of potential abuse of the binary to proxy execution via external VBScript
# MITRE Tactic: Execution
# Tags: attack.execution, attack.t1059.005, attack.defense-evasion, attack.t1218, attack.t1202

Image IN ("*\\calc.exe", "*\\cmd.exe", "*\\cscript.exe", "*\\mshta.exe", "*\\notepad.exe", "*\\powershell.exe", "*\\pwsh.exe", "*\\wscript.exe") OR Image IN ("*\\AppData\\Local\\*", "*\\AppData\\Roaming\\*", "*:\\Users\\Public\\*", "*:\\Temp\\*", "*:\\Windows\\Temp\\*", "*:\\PerfLogs\\*") ParentImage IN ("*\\bginfo.exe", "*\\bginfo64.exe")