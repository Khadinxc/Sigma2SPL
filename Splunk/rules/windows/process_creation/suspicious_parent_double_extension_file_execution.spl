# Title: Suspicious Parent Double Extension File Execution
# Author: frack113, Nasreddine Bencherchali (Nextron Systems)
# Date: 2023-01-06
# Level: high
# Description: Detect execution of suspicious double extension files in ParentCommandLine
# MITRE Tactic: Defense Evasion
# Tags: attack.defense-evasion, attack.t1036.007

ParentImage IN ("*.doc.lnk", "*.docx.lnk", "*.xls.lnk", "*.xlsx.lnk", "*.ppt.lnk", "*.pptx.lnk", "*.rtf.lnk", "*.pdf.lnk", "*.txt.lnk", "*.doc.js", "*.docx.js", "*.xls.js", "*.xlsx.js", "*.ppt.js", "*.pptx.js", "*.rtf.js", "*.pdf.js", "*.txt.js") OR ParentCommandLine IN ("*.doc.lnk*", "*.docx.lnk*", "*.xls.lnk*", "*.xlsx.lnk*", "*.ppt.lnk*", "*.pptx.lnk*", "*.rtf.lnk*", "*.pdf.lnk*", "*.txt.lnk*", "*.doc.js*", "*.docx.js*", "*.xls.js*", "*.xlsx.js*", "*.ppt.js*", "*.pptx.js*", "*.rtf.js*", "*.pdf.js*", "*.txt.js*")