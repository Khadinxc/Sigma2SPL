# Title: HackTool - SharpImpersonation Execution
# Author: Sai Prashanth Pulisetti @pulisettis, Nasreddine Bencherchali (Nextron Systems)
# Date: 2022-12-27
# Level: high
# Description: Detects execution of the SharpImpersonation tool. Which can be used to manipulate tokens on a Windows computers remotely (PsExec/WmiExec) or interactively
# MITRE Tactic: Privilege Escalation
# Tags: attack.privilege-escalation, attack.defense-evasion, attack.t1134.001, attack.t1134.003

(CommandLine="* user:*" CommandLine="* binary:*") OR (CommandLine="* user:*" CommandLine="* shellcode:*") OR CommandLine IN ("* technique:CreateProcessAsUserW*", "* technique:ImpersonateLoggedOnuser*") OR Image="*\\SharpImpersonation.exe" OR OriginalFileName="SharpImpersonation.exe"