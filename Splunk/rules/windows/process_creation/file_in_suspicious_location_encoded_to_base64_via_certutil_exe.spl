# Title: File In Suspicious Location Encoded To Base64 Via Certutil.EXE
# Author: Nasreddine Bencherchali (Nextron Systems)
# Date: 2023-05-15
# Level: high
# Description: Detects the execution of certutil with the "encode" flag to encode a file to base64 where the files are located in potentially suspicious locations
# MITRE Tactic: Defense Evasion
# Tags: attack.defense-evasion, attack.t1027

CommandLine="*-encode*" OR CommandLine="*/encode*" OR CommandLine="*–encode*" OR CommandLine="*—encode*" OR CommandLine="*―encode*" CommandLine IN ("*\\AppData\\Roaming\\*", "*\\Desktop\\*", "*\\Local\\Temp\\*", "*\\PerfLogs\\*", "*\\Users\\Public\\*", "*\\Windows\\Temp\\*", "*$Recycle.Bin*") Image="*\\certutil.exe" OR OriginalFileName="CertUtil.exe"