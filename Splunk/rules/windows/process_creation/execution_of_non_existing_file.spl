# Title: Execution Of Non-Existing File
# Author: Max Altgelt (Nextron Systems)
# Date: 2021-12-09
# Level: high
# Description: Checks whether the image specified in a process creation event is not a full, absolute path (caused by process ghosting or other unorthodox methods to start a process)
# MITRE Tactic: Defense Evasion
# Tags: attack.defense-evasion

NOT Image="*\\*" NOT (Image IN ("System", "Registry", "MemCompression", "vmmem") OR CommandLine IN ("Registry", "MemCompression", "vmmem") OR Image IN ("-", "") OR NOT Image=*)