# Title: Remote File Download Via Findstr.EXE
# Author: Furkan CALISKAN, @caliskanfurkan_, @oscd_initiative, Nasreddine Bencherchali (Nextron Systems)
# Date: 2020-10-05
# Level: medium
# Description: Detects execution of "findstr" with specific flags and a remote share path. This specific set of CLI flags would allow "findstr" to download the content of the file located on the remote share as described in the LOLBAS entry.
# MITRE Tactic: Defense Evasion
# Tags: attack.defense-evasion, attack.credential-access, attack.command-and-control, attack.t1218, attack.t1564.004, attack.t1552.001, attack.t1105

CommandLine="*findstr*" OR Image="*findstr.exe" OR OriginalFileName="FINDSTR.EXE" CommandLine="* -v *" OR CommandLine="* /v *" OR CommandLine="* –v *" OR CommandLine="* —v *" OR CommandLine="* ―v *" CommandLine="* -l *" OR CommandLine="* /l *" OR CommandLine="* –l *" OR CommandLine="* —l *" OR CommandLine="* ―l *" CommandLine="*\\\\*"