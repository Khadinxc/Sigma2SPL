# Title: Creation of WerFault.exe/Wer.dll in Unusual Folder
# Author: frack113
# Date: 2022-05-09
# Level: medium
# Description: Detects the creation of a file named "WerFault.exe" or "wer.dll" in an uncommon folder, which could be a sign of WerFault DLL hijacking.
# MITRE Tactic: Privilege Escalation
# Tags: attack.privilege-escalation, attack.persistence, attack.defense-evasion, attack.t1574.001

TargetFilename IN ("*\\WerFault.exe", "*\\wer.dll") NOT (TargetFilename IN ("C:\\Windows\\SoftwareDistribution\\*", "C:\\Windows\\System32\\*", "C:\\Windows\\SysWOW64\\*", "C:\\Windows\\WinSxS\\*", "C:\\Windows\\UUS\\arm64\\*"))