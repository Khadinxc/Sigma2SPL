# Title: Unusual File Download from Direct IP Address
# Author: Nasreddine Bencherchali (Nextron Systems), Florian Roth (Nextron Systems)
# Date: 2022-09-07
# Level: high
# Description: Detects the download of suspicious file type from URLs with IP
# MITRE Tactic: Defense Evasion
# Tags: attack.defense-evasion, attack.t1564.004

TargetFilename IN ("*.ps1:Zone*", "*.bat:Zone*", "*.exe:Zone*", "*.vbe:Zone*", "*.vbs:Zone*", "*.dll:Zone*", "*.one:Zone*", "*.cmd:Zone*", "*.hta:Zone*", "*.xll:Zone*", "*.lnk:Zone*")
| regex Contents="http[s]?://[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}"