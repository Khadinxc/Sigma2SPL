# Title: DNS Query To Common Malware Hosting and Shortener Services
# Author: Ahmed Nosir (@egycondor)
# Date: 2025-06-02
# Level: medium
# Description: Detects DNS queries to domains commonly used by threat actors to host malware payloads or redirect through URL shorteners.
# These include platforms like Cloudflare Workers, TryCloudflare, InfinityFree, and URL shorteners such as tinyurl and lihi.cc.
# Such DNS activity can indicate potential delivery or command-and-control communication attempts.
# MITRE Tactic: Command and Control
# Tags: attack.command-and-control, attack.t1071.004
# False Positives:
#   - Legitimate use of these services is possible but rare in enterprise environments

QueryName IN ("*msapp.workers.dev*", "*trycloudflare.com*", "*infinityfreeapp.com*", "*my5353.com*", "*reurl.cc*", "*lihi.cc*", "*tinyurl.com*")