# Title: Potential SentinelOne Shell Context Menu Scan Command Tampering
# Author: Nasreddine Bencherchali (Nextron Systems)
# Date: 2024-03-06
# Level: medium
# Description: Detects potentially suspicious changes to the SentinelOne context menu scan command by a process other than SentinelOne.
# MITRE Tactic: Persistence
# Tags: attack.persistence

TargetObject="*\\shell\\SentinelOneScan\\command\\*" NOT (Image IN ("*C:\\Program Files\\SentinelOne\\", "*C:\\Program Files (x86)\\SentinelOne\\") OR (Details="*\\SentinelScanFromContextMenu.exe*" Details IN ("C:\\Program Files\\SentinelOne\\Sentinel Agent*", "C:\\Program Files (x86)\\SentinelOne\\Sentinel Agent*")))