# Title: Hypervisor Enforced Code Integrity Disabled
# Author: Nasreddine Bencherchali (Nextron Systems), Anish Bogati
# Date: 2023-03-14
# Level: high
# Description: Detects changes to the HypervisorEnforcedCodeIntegrity registry key and the "Enabled" value being set to 0 in order to disable the Hypervisor Enforced Code Integrity feature. This allows an attacker to load unsigned and untrusted code to be run in the kernel
# MITRE Tactic: Defense Evasion
# Tags: attack.defense-evasion, attack.t1562.001

Details="DWORD (0x00000000)" TargetObject IN ("*\\Control\\DeviceGuard\\HypervisorEnforcedCodeIntegrity", "*\\Control\\DeviceGuard\\Scenarios\\HypervisorEnforcedCodeIntegrity\\Enabled", "*\\Microsoft\\Windows\\DeviceGuard\\HypervisorEnforcedCodeIntegrity")