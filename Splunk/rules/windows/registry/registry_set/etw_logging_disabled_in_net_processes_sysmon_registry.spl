# Title: ETW Logging Disabled In .NET Processes - Sysmon Registry
# Author: Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)
# Date: 2020-06-05
# Level: high
# Description: Potential adversaries stopping ETW providers recording loaded .NET assemblies.
# MITRE Tactic: Persistence
# Tags: attack.persistence, attack.defense-evasion, attack.t1112, attack.t1562

(Details IN (0, "DWORD (0x00000000)") TargetObject IN ("*\\COMPlus_ETWEnabled", "*\\COMPlus_ETWFlags")) OR (Details="DWORD (0x00000000)" TargetObject="*SOFTWARE\\Microsoft\\.NETFramework\\ETWEnabled")