# Title: FileFix - Command Evidence in TypedPaths
# Author: Alfie Champion (delivr.to), Swachchhanda Shrawan Poudel (Nextron Systems)
# Date: 2025-07-05
# Level: high
# Description: Detects commonly-used chained commands and strings in the most recent 'url' value of the 'TypedPaths' key, which could be indicative of a user being targeted by the FileFix technique.
# MITRE Tactic: Execution
# Tags: attack.execution, attack.t1204.004

Details="*#*" Details="*http*" TargetObject="*\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\TypedPaths\\url1" Details IN ("*account*", "*anti-bot*", "*botcheck*", "*captcha*", "*challenge*", "*confirmation*", "*fraud*", "*human*", "*identification*", "*identificator*", "*identity*", "*robot*", "*validation*", "*verification*", "*verify*") OR Details IN ("*%comspec%*", "*bitsadmin*", "*certutil*", "*cmd*", "*cscript*", "*curl*", "*finger*", "*mshta*", "*powershell*", "*pwsh*", "*regsvr32*", "*rundll32*", "*schtasks*", "*wget*", "*wscript*")