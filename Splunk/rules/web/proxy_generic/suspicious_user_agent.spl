# Title: Suspicious User Agent
# Author: Florian Roth (Nextron Systems)
# Date: 2017-07-08
# Level: high
# Description: Detects suspicious malformed user agent strings in proxy logs
# MITRE Tactic: Command and Control
# Tags: attack.command-and-control, attack.t1071.001

"c-useragent" IN ("user-agent*", "Mozilla/3.0 *", "Mozilla/2.0 *", "Mozilla/1.0 *", "Mozilla *", " Mozilla/*", "Mozila/*", "Mozilla/4.0 (compatible; MSIE 6.0; MS Web Services Client Protocol*") OR "c-useragent" IN ("* (compatible;MSIE *", "*.0;Windows NT *", "*loader*") OR "c-useragent" IN ("_", "CertUtil URL Agent", "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:60.0)", "Mozilla/5.0 (Windows NT 6.3; WOW64; rv:28.0) Gecko/20100101 Firefox/28.0", "HTTPS", "Erbium-UA-4ce7c27cb4be9d32e333bf032c88235a", "x", "xxx") NOT ("c-useragent"="Mozilla/3.0 * Acrobat *" OR "cs-host" IN ("*.acrobat.com", "*.adobe.com", "*.adobe.io"))