# Title: Indirect Command Execution From Script File Via Bash.EXE
# Author: Nasreddine Bencherchali (Nextron Systems)
# Date: 2023-08-15
# Level: medium
# Description: Detects execution of Microsoft bash launcher without any flags to execute the content of a bash script directly.
# This can be used to potentially bypass defenses and execute Linux or Windows-based binaries directly via bash.
# MITRE Tactic: Defense Evasion
# Tags: attack.defense-evasion, attack.t1202

Image IN ("*:\\Windows\\System32\\bash.exe", "*:\\Windows\\SysWOW64\\bash.exe") OR OriginalFileName="Bash.exe" NOT (CommandLine IN ("*bash.exe -*", "*bash -*") OR CommandLine="" OR NOT CommandLine=* OR CommandLine IN ("bash.exe", "bash"))