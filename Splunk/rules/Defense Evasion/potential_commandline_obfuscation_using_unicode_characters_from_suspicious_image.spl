# Title: Potential CommandLine Obfuscation Using Unicode Characters From Suspicious Image
# Author: frack113, Florian Roth (Nextron Systems), Josh Nickels
# Date: 2024-09-02
# Level: high
# Description: Detects potential commandline obfuscation using unicode characters.
# Adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.
# MITRE Tactic: Defense Evasion
# Tags: attack.defense-evasion, attack.t1027

Image IN ("*\\cmd.exe", "*\\cscript.exe", "*\\powershell.exe", "*\\powershell_ise.exe", "*\\pwsh.exe", "*\\wscript.exe") OriginalFileName IN ("Cmd.EXE", "cscript.exe", "PowerShell.EXE", "PowerShell_ISE.EXE", "pwsh.dll", "wscript.exe") CommandLine IN ("*ˣ*", "*˪*", "*ˢ*", "*∕*", "*⁄*", "*―*", "*—*", "* *", "*¯*", "*®*", "*¶*", "*⠀*")