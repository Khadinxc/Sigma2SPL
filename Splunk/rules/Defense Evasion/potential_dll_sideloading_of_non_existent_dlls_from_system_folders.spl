# Title: Potential DLL Sideloading Of Non-Existent DLLs From System Folders
# Author: Nasreddine Bencherchali (Nextron Systems), SBousseaden
# Date: 2022-12-09
# Level: high
# Description: Detects DLL sideloading of system DLLs that are not present on the system by default (at least not in system directories).
# Usually this technique is used to achieve UAC bypass or privilege escalation.
# MITRE Tactic: Defense Evasion
# Tags: attack.defense-evasion, attack.persistence, attack.privilege-escalation, attack.t1574.001

ImageLoaded IN ("*:\\Windows\\System32\\TSMSISrv.dll", "*:\\Windows\\System32\\TSVIPSrv.dll", "*:\\Windows\\System32\\wbem\\wbemcomn.dll", "*:\\Windows\\System32\\WLBSCTRL.dll", "*:\\Windows\\System32\\wow64log.dll", "*:\\Windows\\System32\\WptsExtensions.dll") NOT (Signature="Microsoft Windows" SignatureStatus="Valid" Signed="true")