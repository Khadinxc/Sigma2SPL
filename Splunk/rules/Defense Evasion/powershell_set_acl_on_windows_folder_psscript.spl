# Title: PowerShell Set-Acl On Windows Folder - PsScript
# Author: frack113, Nasreddine Bencherchali (Nextron Systems)
# Date: 2023-07-18
# Level: high
# Description: Detects PowerShell scripts to set the ACL to a file in the Windows folder
# MITRE Tactic: Defense Evasion
# Tags: attack.defense-evasion, attack.t1222

ScriptBlockText="*Set-Acl *" ScriptBlockText="*-AclObject *" ScriptBlockText IN ("*-Path \"C:\\Windows*", "*-Path \"C:/Windows*", "*-Path 'C:\\Windows*", "*-Path 'C:/Windows*", "*-Path C:\\Windows*", "*-Path C:/Windows*", "*-Path $env:windir*", "*-Path \"$env:windir*", "*-Path '$env:windir*") ScriptBlockText IN ("*FullControl*", "*Allow*")