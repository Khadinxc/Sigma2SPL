# Title: Suspicious File Encoded To Base64 Via Certutil.EXE
# Author: Nasreddine Bencherchali (Nextron Systems)
# Date: 2023-05-15
# Level: high
# Description: Detects the execution of certutil with the "encode" flag to encode a file to base64 where the extensions of the file is suspicious
# MITRE Tactic: Defense Evasion
# Tags: attack.defense-evasion, attack.t1027

CommandLine="*-encode*" OR CommandLine="*/encode*" OR CommandLine="*–encode*" OR CommandLine="*—encode*" OR CommandLine="*―encode*" CommandLine IN ("*.acl*", "*.bat*", "*.doc*", "*.gif*", "*.jpeg*", "*.jpg*", "*.mp3*", "*.pdf*", "*.png*", "*.ppt*", "*.tmp*", "*.xls*", "*.xml*") Image="*\\certutil.exe" OR OriginalFileName="CertUtil.exe"