# Title: Potentially Suspicious Execution From Parent Process In Public Folder
# Author: Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)
# Date: 2022-02-25
# Level: high
# Description: Detects a potentially suspicious execution of a parent process located in the "\Users\Public" folder executing a child process containing references to shell or scripting binaries and commandlines.
# MITRE Tactic: Defense Evasion
# Tags: attack.defense-evasion, attack.execution, attack.t1564, attack.t1059

Image IN ("*\\bitsadmin.exe", "*\\certutil.exe", "*\\cmd.exe", "*\\cscript.exe", "*\\mshta.exe", "*\\powershell.exe", "*\\pwsh.exe", "*\\regsvr32.exe", "*\\rundll32.exe", "*\\wscript.exe") OR CommandLine IN ("*bitsadmin*", "*certutil*", "*cscript*", "*mshta*", "*powershell*", "*regsvr32*", "*rundll32*", "*wscript*") ParentImage="*:\\Users\\Public\\*"