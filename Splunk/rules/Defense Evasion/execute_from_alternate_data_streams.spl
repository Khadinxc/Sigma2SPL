# Title: Execute From Alternate Data Streams
# Author: frack113
# Date: 2021-09-01
# Level: medium
# Description: Detects execution from an Alternate Data Stream (ADS). Adversaries may use NTFS file attributes to hide their malicious data in order to evade detection
# MITRE Tactic: Defense Evasion
# Tags: attack.defense-evasion, attack.t1564.004

CommandLine="*txt:*" (CommandLine="*esentutl *" CommandLine="* /y *" CommandLine="* /d *" CommandLine="* /o *") OR (CommandLine="*makecab *" CommandLine="*.cab*") OR (CommandLine="*reg *" CommandLine="* export *") OR (CommandLine="*regedit *" CommandLine="* /E *") OR (CommandLine="*type *" CommandLine="* > *")