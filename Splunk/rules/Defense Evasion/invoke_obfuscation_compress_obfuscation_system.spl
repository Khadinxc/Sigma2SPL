# Title: Invoke-Obfuscation COMPRESS OBFUSCATION - System
# Author: Timur Zinniatullin, oscd.community
# Date: 2020-10-18
# Level: medium
# Description: Detects Obfuscated Powershell via COMPRESS OBFUSCATION
# MITRE Tactic: Defense Evasion
# Tags: attack.defense-evasion, attack.t1027, attack.execution, attack.t1059.001

EventID=7045 ImagePath IN ("*:system.io.compression.deflatestream*", "*system.io.streamreader*") ImagePath="*new-object*" ImagePath="*text.encoding]::ascii*" ImagePath="*readtoend*" Provider_Name="Service Control Manager"