# Title: Suspicious Ping/Del Command Combination
# Author: Ilya Krestinichev
# Date: 2022-11-03
# Level: high
# Description: Detects a method often used by ransomware. Which combines the "ping" to wait a couple of seconds and then "del" to delete the file in question. Its used to hide the file responsible for the initial infection for example
# MITRE Tactic: Defense Evasion
# Tags: attack.defense-evasion, attack.t1070.004

CommandLine="*ping*" CommandLine="*del *" CommandLine="* -n *" OR CommandLine="* /n *" OR CommandLine="* –n *" OR CommandLine="* —n *" OR CommandLine="* ―n *" CommandLine="* -f *" OR CommandLine="* /f *" OR CommandLine="* –f *" OR CommandLine="* —f *" OR CommandLine="* ―f *" OR CommandLine="* -q *" OR CommandLine="* /q *" OR CommandLine="* –q *" OR CommandLine="* —q *" OR CommandLine="* ―q *" CommandLine="*Nul*"