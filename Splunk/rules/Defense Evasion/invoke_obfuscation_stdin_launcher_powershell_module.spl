# Title: Invoke-Obfuscation STDIN+ Launcher - PowerShell Module
# Author: Jonathan Cheong, oscd.community
# Date: 2020-10-15
# Level: high
# Description: Detects Obfuscated use of stdin to execute PowerShell
# MITRE Tactic: Defense Evasion
# Tags: attack.defense-evasion, attack.t1027, attack.execution, attack.t1059.001

*
| regex Payload="cmd.{0,5}(?:/c|/r).+powershell.+(?:\\$\\{?input\\}?|noexit).+\""