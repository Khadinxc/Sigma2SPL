# Title: Suspicious Process Parents
# Author: Florian Roth (Nextron Systems)
# Date: 2022-03-21
# Level: high
# Description: Detects suspicious parent processes that should not have any children or should only have a single possible child program
# MITRE Tactic: Defense Evasion
# Tags: attack.defense-evasion, attack.t1036

ParentImage IN ("*\\minesweeper.exe", "*\\winver.exe", "*\\bitsadmin.exe") OR (ParentImage IN ("*\\csrss.exe", "*\\certutil.exe", "*\\eventvwr.exe", "*\\calc.exe", "*\\notepad.exe") NOT (NOT Image=* OR Image IN ("*\\WerFault.exe", "*\\wermgr.exe", "*\\conhost.exe", "*\\mmc.exe", "*\\win32calc.exe", "*\\notepad.exe")))