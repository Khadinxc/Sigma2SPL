# Title: Regsvr32 Execution From Potential Suspicious Location
# Author: Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)
# Date: 2023-05-26
# Level: medium
# Description: Detects execution of regsvr32 where the DLL is located in a potentially suspicious location.
# MITRE Tactic: Defense Evasion
# Tags: attack.defense-evasion, attack.t1218.010
# False Positives:
#   - Some installers might execute "regsvr32" with DLLs located in %TEMP% or in %PROGRAMDATA%. Apply additional filters if necessary.

CommandLine IN ("*:\\ProgramData\\*", "*:\\Temp\\*", "*:\\Users\\Public\\*", "*:\\Windows\\Temp\\*", "*\\AppData\\Local\\Temp\\*", "*\\AppData\\Roaming\\*") Image="*\\regsvr32.exe" OR OriginalFileName="REGSVR32.EXE"