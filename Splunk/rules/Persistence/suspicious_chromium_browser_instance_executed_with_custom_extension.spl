# Title: Suspicious Chromium Browser Instance Executed With Custom Extension
# Author: Aedan Russell, frack113, X__Junior (Nextron Systems)
# Date: 2022-06-19
# Level: high
# Description: Detects a suspicious process spawning a Chromium based browser process with the 'load-extension' flag to start an instance with a custom extension
# MITRE Tactic: Persistence
# Tags: attack.persistence, attack.t1176.001

CommandLine="*--load-extension=*" Image IN ("*\\brave.exe", "*\\chrome.exe", "*\\msedge.exe", "*\\opera.exe", "*\\vivaldi.exe") ParentImage IN ("*\\cmd.exe", "*\\cscript.exe", "*\\mshta.exe", "*\\powershell.exe", "*\\pwsh.exe", "*\\regsvr32.exe", "*\\rundll32.exe", "*\\wscript.exe")