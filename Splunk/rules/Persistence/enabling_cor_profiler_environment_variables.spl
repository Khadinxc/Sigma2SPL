# Title: Enabling COR Profiler Environment Variables
# Author: Jose Rodriguez (@Cyb3rPandaH), OTR (Open Threat Research), Jimmy Bayne (@bohops)
# Date: 2020-09-10
# Level: medium
# Description: Detects .NET Framework CLR and .NET Core CLR "cor_enable_profiling" and "cor_profiler" variables being set and configured.
# MITRE Tactic: Persistence
# Tags: attack.persistence, attack.privilege-escalation, attack.defense-evasion, attack.t1574.012

TargetObject IN ("*\\COR_ENABLE_PROFILING", "*\\COR_PROFILER", "*\\CORECLR_ENABLE_PROFILING") OR TargetObject="*\\CORECLR_PROFILER_PATH*"