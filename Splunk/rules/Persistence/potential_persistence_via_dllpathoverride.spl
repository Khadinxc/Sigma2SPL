# Title: Potential Persistence Via DLLPathOverride
# Author: Nasreddine Bencherchali (Nextron Systems)
# Date: 2022-07-21
# Level: high
# Description: Detects when an attacker adds a new "DLLPathOverride" value to the "Natural Language" key in order to achieve persistence which will get invoked by "SearchIndexer.exe" process
# MITRE Tactic: Persistence
# Tags: attack.persistence

TargetObject="*\\SYSTEM\\CurrentControlSet\\Control\\ContentIndex\\Language\\*" TargetObject IN ("*\\StemmerDLLPathOverride*", "*\\WBDLLPathOverride*", "*\\StemmerClass*", "*\\WBreakerClass*")