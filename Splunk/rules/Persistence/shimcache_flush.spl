# Title: ShimCache Flush
# Author: Florian Roth (Nextron Systems)
# Date: 2021-02-01
# Level: high
# Description: Detects actions that clear the local ShimCache and remove forensic evidence
# MITRE Tactic: Persistence
# Tags: attack.persistence, attack.defense-evasion, attack.t1112

(CommandLine="*rundll32*" CommandLine="*apphelp.dll*" CommandLine IN ("*ShimFlushCache*", "*#250*")) OR (CommandLine="*rundll32*" CommandLine="*kernel32.dll*" CommandLine IN ("*BaseFlushAppcompatCache*", "*#46*")) | table Image,CommandLine,ParentCommandLine