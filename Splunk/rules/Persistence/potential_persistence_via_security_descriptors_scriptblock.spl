# Title: Potential Persistence Via Security Descriptors - ScriptBlock
# Author: Nasreddine Bencherchali (Nextron Systems)
# Date: 2023-01-05
# Level: high
# Description: Detects usage of certain functions and keywords that are used to manipulate security descriptors in order to potentially set a backdoor. As seen used in the DAMP project.
# MITRE Tactic: Persistence
# Tags: attack.persistence, attack.defense-evasion, attack.privilege-escalation

ScriptBlockText IN ("*\\Lsa\\JD*", "*\\Lsa\\Skew1*", "*\\Lsa\\Data*", "*\\Lsa\\GBG*") ScriptBlockText="*win32_Trustee*" ScriptBlockText="*win32_Ace*" ScriptBlockText="*.AccessMask*" ScriptBlockText="*.AceType*" ScriptBlockText="*.SetSecurityDescriptor*"