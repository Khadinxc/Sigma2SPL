# Title: Private Keys Reconnaissance Via CommandLine Tools
# Author: frack113, Nasreddine Bencherchali (Nextron Systems)
# Date: 2021-07-20
# Level: medium
# Description: Adversaries may search for private key certificate files on compromised systems for insecurely stored credential
# MITRE Tactic: Credential Access
# Tags: attack.credential-access, attack.t1552.004

CommandLine IN ("*.key*", "*.pgp*", "*.gpg*", "*.ppk*", "*.p12*", "*.pem*", "*.pfx*", "*.cer*", "*.p7b*", "*.asc*") (CommandLine="*dir *" Image="*\\cmd.exe" OR OriginalFileName="Cmd.Exe") OR (CommandLine="*Get-ChildItem *" Image IN ("*\\powershell.exe", "*\\pwsh.exe") OR OriginalFileName IN ("PowerShell.EXE", "pwsh.dll")) OR Image="*\\findstr.exe" OR OriginalFileName="FINDSTR.EXE"