# Title: Permission Misconfiguration Reconnaissance Via Findstr.EXE
# Author: Nasreddine Bencherchali (Nextron Systems)
# Date: 2022-08-12
# Level: medium
# Description: Detects usage of findstr with the "EVERYONE" or "BUILTIN" keywords.
# This was seen being used in combination with "icacls" and other utilities to spot misconfigured files or folders permissions.
# MITRE Tactic: Credential Access
# Tags: attack.credential-access, attack.t1552.006

(CommandLine IN ("*\"Everyone\"*", "*'Everyone'*", "*\"BUILTIN\\\"*", "*'BUILTIN\\'*") Image IN ("*\\find.exe", "*\\findstr.exe") OR OriginalFileName IN ("FIND.EXE", "FINDSTR.EXE")) OR (CommandLine="*icacls *" CommandLine="*findstr *" CommandLine="*Everyone*")