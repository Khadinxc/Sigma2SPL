# Title: Credential Dumping Activity By Python Based Tool
# Author: Bhabesh Raj, Jonhnathan Ribeiro
# Date: 2023-11-27
# Level: high
# Description: Detects LSASS process access for potential credential dumping by a Python-like tool such as LaZagne or Pypykatz.
# MITRE Tactic: Credential Access
# Tags: attack.credential-access, attack.t1003.001, attack.s0349

CallTrace IN ("*python27.dll+*", "*python3*.dll+*") CallTrace="*_ctypes.pyd+*" CallTrace="*:\\Windows\\System32\\KERNELBASE.dll+*" CallTrace="*:\\Windows\\SYSTEM32\\ntdll.dll+*" GrantedAccess="0x1FFFFF" TargetImage="*\\lsass.exe"