# Title: MSSQL Server Failed Logon From External Network
# Author: j4son
# Date: 2023-10-11
# Level: medium
# Description: Detects failed logon attempts from clients with external network IP to an MSSQL server. This can be a sign of a bruteforce attack.
# MITRE Tactic: Credential Access
# Tags: attack.credential-access, attack.t1110

EventID=18456 Provider_Name="*MSSQL*" NOT (Data IN ("*CLIENT: 10.*", "*CLIENT: 172.16.*", "*CLIENT: 172.17.*", "*CLIENT: 172.18.*", "*CLIENT: 172.19.*", "*CLIENT: 172.20.*", "*CLIENT: 172.21.*", "*CLIENT: 172.22.*", "*CLIENT: 172.23.*", "*CLIENT: 172.24.*", "*CLIENT: 172.25.*", "*CLIENT: 172.26.*", "*CLIENT: 172.27.*", "*CLIENT: 172.28.*", "*CLIENT: 172.29.*", "*CLIENT: 172.30.*", "*CLIENT: 172.31.*", "*CLIENT: 192.168.*", "*CLIENT: 127.*", "*CLIENT: 169.254.*", "*CLIENT: <local machine>*"))