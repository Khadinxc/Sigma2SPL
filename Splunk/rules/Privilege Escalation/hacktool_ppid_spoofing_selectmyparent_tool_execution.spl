# Title: HackTool - PPID Spoofing SelectMyParent Tool Execution
# Author: Florian Roth (Nextron Systems)
# Date: 2022-07-23
# Level: high
# Description: Detects the use of parent process ID spoofing tools like Didier Stevens tool SelectMyParent
# MITRE Tactic: Privilege Escalation
# Tags: attack.privilege-escalation, attack.defense-evasion, attack.t1134.004
# False Positives:
#   - Unlikely

Image="*\\SelectMyParent.exe" OR CommandLine IN ("*PPID-spoof*", "*ppid_spoof*", "*spoof-ppid*", "*spoof_ppid*", "*ppidspoof*", "*spoofppid*", "*spoofedppid*", "* -spawnto *") OR OriginalFileName IN ("*PPID-spoof*", "*ppid_spoof*", "*spoof-ppid*", "*spoof_ppid*", "*ppidspoof*", "*spoofppid*", "*spoofedppid*") OR Description="SelectMyParent" OR Hashes IN ("*IMPHASH=04D974875BD225F00902B4CAD9AF3FBC*", "*IMPHASH=A782AF154C9E743DDF3F3EB2B8F3D16E*", "*IMPHASH=89059503D7FBF470E68F7E63313DA3AD*", "*IMPHASH=CA28337632625C8281AB8A130B3D6BAD*")