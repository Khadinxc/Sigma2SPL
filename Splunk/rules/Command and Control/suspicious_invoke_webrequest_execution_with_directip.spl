# Title: Suspicious Invoke-WebRequest Execution With DirectIP
# Author: Nasreddine Bencherchali (Nextron Systems)
# Date: 2023-04-21
# Level: medium
# Description: Detects calls to PowerShell with Invoke-WebRequest cmdlet using direct IP access
# MITRE Tactic: Command and Control
# Tags: attack.command-and-control, attack.t1105

CommandLine IN ("*curl *", "*Invoke-RestMethod*", "*Invoke-WebRequest*", "* irm *", "*iwr *", "*wget *") Image IN ("*\\powershell_ise.exe", "*\\powershell.exe", "*\\pwsh.exe") OR OriginalFileName IN ("powershell_ise.EXE", "PowerShell.EXE", "pwsh.dll") CommandLine IN ("*://1*", "*://2*", "*://3*", "*://4*", "*://5*", "*://6*", "*://7*", "*://8*", "*://9*")