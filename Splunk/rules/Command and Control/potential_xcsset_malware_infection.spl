# Title: Potential XCSSET Malware Infection
# Author: Tim Rauch (rule), Elastic (idea)
# Date: 2022-10-17
# Level: medium
# Description: Identifies the execution traces of the XCSSET malware. XCSSET is a macOS trojan that primarily spreads via Xcode projects and maliciously modifies applications. Infected users are also vulnerable to having their credentials, accounts, and other vital data stolen.
# MITRE Tactic: Command and Control
# Tags: attack.command-and-control

(CommandLine IN ("*/sys/log.php*", "*/sys/prepod.php*", "*/sys/bin/Pods*") Image="*/curl" ParentImage="*/bash" CommandLine="*https://*") OR (CommandLine="*/Users/*" CommandLine="*/Library/Group Containers/*" Image="*/osacompile" ParentImage="*/bash") OR (CommandLine="*LSUIElement*" CommandLine="*/Users/*" CommandLine="*/Library/Group Containers/*" Image="*/plutil" ParentImage="*/bash") OR (CommandLine="*-r*" CommandLine="*/Users/*" CommandLine="*/Library/Group Containers/*" Image="*/zip")