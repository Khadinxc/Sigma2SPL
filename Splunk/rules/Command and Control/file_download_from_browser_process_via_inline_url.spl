# Title: File Download From Browser Process Via Inline URL
# Author: Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)
# Date: 2022-01-11
# Level: medium
# Description: Detects execution of a browser process with a URL argument pointing to a file with a potentially interesting extension. This can be abused to download arbitrary files or to hide from the user for example by launching the browser in a minimized state.
# MITRE Tactic: Command and Control
# Tags: attack.command-and-control, attack.t1105

CommandLine IN ("*.7z", "*.dat", "*.dll", "*.exe", "*.hta", "*.ps1", "*.psm1", "*.txt", "*.vbe", "*.vbs", "*.zip") CommandLine="*http*" Image IN ("*\\brave.exe", "*\\chrome.exe", "*\\msedge.exe", "*\\opera.exe", "*\\vivaldi.exe")