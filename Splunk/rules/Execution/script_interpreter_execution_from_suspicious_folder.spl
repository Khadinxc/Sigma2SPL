# Title: Script Interpreter Execution From Suspicious Folder
# Author: Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)
# Date: 2022-02-08
# Level: high
# Description: Detects a suspicious script execution in temporary folders or folders accessible by environment variables
# MITRE Tactic: Execution
# Tags: attack.execution, attack.t1059

CommandLine IN ("* -ep bypass *", "* -ExecutionPolicy bypass *", "* -w hidden *", "*/e:javascript *", "*/e:Jscript *", "*/e:vbscript *") OR Image IN ("*\\cscript.exe", "*\\mshta.exe", "*\\wscript.exe") OR OriginalFileName IN ("cscript.exe", "mshta.exe", "wscript.exe") CommandLine IN ("*:\\Perflogs\\*", "*:\\Users\\Public\\*", "*\\AppData\\Local\\Temp*", "*\\AppData\\Roaming\\Temp*", "*\\Temporary Internet*", "*\\Windows\\Temp*") OR (CommandLine="*:\\Users\\*" CommandLine="*\\Favorites\\*") OR (CommandLine="*:\\Users\\*" CommandLine="*\\Favourites\\*") OR (CommandLine="*:\\Users\\*" CommandLine="*\\Contacts\\*")