# Title: WSL Child Process Anomaly
# Author: Nasreddine Bencherchali (Nextron Systems)
# Date: 2023-01-23
# Level: medium
# Description: Detects uncommon or suspicious child processes spawning from a WSL process. This could indicate an attempt to evade parent/child relationship detections or persistence attempts via cron using WSL
# MITRE Tactic: Execution
# Tags: attack.execution, attack.defense-evasion, attack.t1218, attack.t1202

ParentImage IN ("*\\wsl.exe", "*\\wslhost.exe") Image IN ("*\\calc.exe", "*\\cmd.exe", "*\\cscript.exe", "*\\mshta.exe", "*\\powershell.exe", "*\\pwsh.exe", "*\\regsvr32.exe", "*\\rundll32.exe", "*\\wscript.exe") OR Image IN ("*\\AppData\\Local\\Temp\\*", "*C:\\Users\\Public\\*", "*C:\\Windows\\Temp\\*", "*C:\\Temp\\*", "*\\Downloads\\*", "*\\Desktop\\*")