# Title: Potential Suspicious Browser Launch From Document Reader Process
# Author: Joseph Kamau
# Date: 2024-05-27
# Level: medium
# Description: Detects when a browser process or browser tab is launched from an application that handles document files such as Adobe, Microsoft Office, etc. And connects to a web application over http(s), this could indicate a possible phishing attempt.
# MITRE Tactic: Execution
# Tags: attack.execution, attack.t1204.002
# False Positives:
#   - Unlikely in most cases, further investigation should be done in the commandline of the browser process to determine the context of the URL accessed.

CommandLine="*http*" Image IN ("*\\brave.exe", "*\\chrome.exe", "*\\firefox.exe", "*\\msedge.exe", "*\\opera.exe", "*\\maxthon.exe", "*\\seamonkey.exe", "*\\vivaldi.exe") ParentImage IN ("*Acrobat Reader*", "*Microsoft Office*", "*PDF Reader*") NOT CommandLine="*https://go.microsoft.com/fwlink/*" NOT (CommandLine IN ("*http://ad.foxitsoftware.com/adlog.php**", "*https://globe-map.foxitservice.com/go.php*do=redirect*"))